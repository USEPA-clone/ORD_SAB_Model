<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrew Murray">

<title>ORD Service Area Boundary Model Documentation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="Documentation_files/libs/clipboard/clipboard.min.js"></script>
<script src="Documentation_files/libs/quarto-html/quarto.js"></script>
<script src="Documentation_files/libs/quarto-html/popper.min.js"></script>
<script src="Documentation_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Documentation_files/libs/quarto-html/anchor.min.js"></script>
<link href="Documentation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Documentation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Documentation_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Documentation_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Documentation_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ORD Service Area Boundary Model Documentation</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrew Murray </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="disclaimer" class="level2">
<h2 class="anchored" data-anchor-id="disclaimer">Disclaimer</h2>
<p>This document is distributed solely for the purpose of pre-dissemination peer review under applicable information quality guidelines. It has not been formally disseminated by the U.S. Environmental Protection Agency. It does not represent and should not be construed to represent any agency determination or policy.</p>
<p><strong>Version 1.0</strong></p>
<p><strong>SDWIS Data Vintage:</strong> 2023 (Quarter 4)</p>
<p>The Office of Research and Development has released a publicly available dataset of community water system (CWS) service area boundaries (SAB). CWS are defined as systems that provide water for human consumption through pipes or other constructed conveyances to at least 15 service connections or serves an average of at least 25 people year-round <span class="citation" data-cites="cws">(<a href="#ref-cws" role="doc-biblioref">U. EPA 2022</a>)</span>. Under the safe drinking water act (SDWA) and various drinking water rules public water systems must test and report on the quality of their drinking water <span class="citation" data-cites="act1974safe">(<a href="#ref-act1974safe" role="doc-biblioref">Act 1974</a>)</span>. These boundaries enable linking SDWA violations to their associated geographic areas, and concomitantly linking treated community water system water to their respective customers. This service area boundary dataset is a combination of publicly available service area boundaries and modeled boundaries. This document describes how the data was collected and modeled and details the modeling techniques used to generate this dataset.</p>
</section>
<section id="list-of-acronyms-abbreviations" class="level1">
<h1>List of Acronyms &amp; Abbreviations</h1>
<table class="table">
<colgroup>
<col style="width: 32%">
<col style="width: 68%">
</colgroup>
<thead>
<tr class="header">
<th>Acronym / Abbreviation</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CWS</td>
<td>Community Water System</td>
</tr>
<tr class="even">
<td>HBSL</td>
<td>Health-Based Screening Level</td>
</tr>
<tr class="odd">
<td>HIFLD</td>
<td>Homeland Infrastructure Foundation-Level Data</td>
</tr>
<tr class="even">
<td>MCL</td>
<td>Maximum Contaminant Level</td>
</tr>
<tr class="odd">
<td>NHGIS</td>
<td>National Historical Geographic Information System</td>
</tr>
<tr class="even">
<td>OOB</td>
<td>Out-of-Bag</td>
</tr>
<tr class="odd">
<td>ORD</td>
<td>EPA Office of Research and Development</td>
</tr>
<tr class="even">
<td>OSM</td>
<td>Open Street Map</td>
</tr>
<tr class="odd">
<td>PWSID</td>
<td>Public Water System Identifier</td>
</tr>
<tr class="even">
<td>SAB</td>
<td>Service Area Boundary</td>
</tr>
<tr class="odd">
<td>SDWA</td>
<td>Safe Drinking Water Act</td>
</tr>
<tr class="even">
<td>SDWIS</td>
<td>Safe Drinking Water Information System</td>
</tr>
</tbody>
</table>
</section>
<section id="summary" class="level1">
<h1>Summary</h1>
<p>Public water systems regulated under SDWA are required to treat their drinking water. A sample of 931 public wells found that “one or more chemical contaminants were detected at concentrations greater than MCLs or HBSLs in more than one in five (22 percent)” of the sampled wells <span class="citation" data-cites="toccalino2010quality">(<a href="#ref-toccalino2010quality" role="doc-biblioref">Toccalino, Norman, and Hitt 2010</a>)</span>. This substantiates the need for federal requirements; these samples were collected prior to treatment and treatment processes, or dilution can substantially reduce the risk of contaminants getting to the consumer. While federal standards help reduce the likelihood of contaminated drinking water, of the total universe of public water systems in the U.S., 6% reported to have violated a health-based drinking water standard and 29% failed to meet at least one monitoring or reporting requirement in 2022 <span class="citation" data-cites="epaCompliance">(<a href="#ref-epaCompliance" role="doc-biblioref">U. S. EPA 2023</a>)</span>. Community water systems have testing and reporting requirements that may increase based on the size of the system, compliance history and local or state specific requirements. While the source of water for a home may be a primary determinate of its quality, the type of system, whether private, mobile home park, small community water system, or large community water system can play an equally important role in the ability for a system to have adequate treatment processes. It is therefore critical that we understand where people are sourcing their water, who is consuming the water, and how it is delivered to their home in order to more completely understand regional and national trends of water quality and the health impacts to the public. This research on the extent of public water use leverages a new spatial disaggregation technique to increase the spatial resolution of public supply estimates in addition to using machine learning techniques to estimate the total number of housing units getting their water from public sources in 2020 at the census block level. After that is achieved we use a random forest model to associate the corresponding public water system ID to each census block identified</p>
<p>The boundaries presented in this dataset are an aggregate of several methods used to present the most accurate representation possible with available data. These methods range between simple collection of public service area data to complex machine learning techniques. Each method is described in detail.</p>
<section id="sdwis-reporting-universe" class="level2">
<h2 class="anchored" data-anchor-id="sdwis-reporting-universe">SDWIS Reporting Universe</h2>
<p>The current ORD dataset (Version 1.0), uses the 2023 (Q4) release of SDWIS data. As of this release, there were a total of 49,396 active community water systems, which primarily serve residential areas (Figure 2). There are many systems, however, which primarily wholesale water to other systems, meaning they do not directly serve water to consumers and therefore do not have a service area boundary. These systems simply source water and deliver it to other systems, who then serve individual customers. The universe of systems in our efforts is limited to currently active community water systems which serve at least 15 service connections or serves an average of at least 25 people for at least 60 days a year. The total number of systems that fit this criteria for 2023 (Q4) is: 46,103. Currently, this dataset does not include service areas for U.S. territories (Puerto Rico, American Samoa, Guam, , Commonwealth of the Northern Mariana Islands, U.S. Virgin Islands).</p>
</section>
<section id="count-of-systems-by-primacy-agency" class="level2">
<h2 class="anchored" data-anchor-id="count-of-systems-by-primacy-agency">Count of Systems by Primacy Agency</h2>
<p>Community water systems each fall under a primacy agency, which is the agency with primary responsibility for implementing SDWA, this is typically the state or territory. The exceptions, where EPA is the primacy agency are Wyoming, the District of Columbia, and federally recognized tribes excluding Navajo Nation. Navajo Nation is currently the only tribe with primacy agency status to enforce SDWA.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-statePlot" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statePlot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Documentation_files/figure-html/fig-statePlot-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statePlot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Bar plot showing the count of active community water systems by state, region or territory.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="systems-by-type-of-service-area" class="level2">
<h2 class="anchored" data-anchor-id="systems-by-type-of-service-area">Systems by Type of Service Area</h2>
<div class="cell">
<div class="cell-output-display">
<div id="fig-systemType" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-systemType-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Documentation_files/figure-html/fig-systemType-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-systemType-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Types of Active Systems in SDWA Reporting
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="state-data" class="level1">
<h1>State Data</h1>
<p>When detailed public water service area boundaries are publicly available from state or municipal sources, we consider that to be the highest quality spatial data possible. A detailed review was conducted of available data and used to determine what would be included in the ORD national map versus what would be modeled. Detailed descriptions of state data are available in the state boundary appendix.</p>
<div class="cell" data-layout-nrow="1">
<div id="tbl-stateCounts" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-stateCounts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Number of system boundaries from state and municipal sources included in the ORD dataset. The total number of systems included is 18,374.
</figcaption>
<div aria-describedby="tbl-stateCounts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="img/state_table_1.png" class="img-fluid figure-img" width="188"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="img/state_table_2.png" class="img-fluid figure-img" width="188"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="img/state_table_3.png" class="img-fluid figure-img" width="188"></p>
</div>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="place-matched-service-area-boundaries" class="level1">
<h1>Place Matched Service Area Boundaries</h1>
<section id="mobile-homes---osm" class="level2">
<h2 class="anchored" data-anchor-id="mobile-homes---osm">Mobile Homes - OSM</h2>
<p>Areas delineated as mobile home parks were extracted from Open Street Map and fuzzy name matched with community water system names reported to SDWIS. To find open street map delineated areas, the point locations for mobile home parks from Homeland Infrastructure Foundation-Level Data <span class="citation" data-cites="hifld">(<a href="#ref-hifld" role="doc-biblioref">HIFLD 2023</a>)</span> was intersected with areas tagged as ‘residental=trailer_park’ in open street map. If an intersection occured, the given names of that mobile home park (from both sources) were matched with SDWIS reported names.</p>
</section>
<section id="mobile-homes---parcels" class="level2">
<h2 class="anchored" data-anchor-id="mobile-homes---parcels">Mobile Homes - Parcels</h2>
<p>Where open street map delineated areas were not present, point locations of mobile home parks from HIFLD <span class="citation" data-cites="hifld">(<a href="#ref-hifld" role="doc-biblioref">2023</a>)</span> were intersected with parcels from REGRID <span class="citation" data-cites="regrid">(<a href="#ref-regrid" role="doc-biblioref">2023</a>)</span>. The name of the mobile home park was then fuzzy matched with SDWIS reported system names.</p>
</section>
</section>
<section id="modeled-service-area-boundaries" class="level1">
<h1>Modeled Service Area Boundaries</h1>
<section id="binary-water-use-model" class="level2">
<h2 class="anchored" data-anchor-id="binary-water-use-model">Binary Water Use Model</h2>
<p>A decision tree model was created to determine the probability that a census block is served by a public water system. This model was levered in two different ways: 1.) to aid in the 1:1 matching discussed later and 2.) as a model input (explanatory variable) for the random forest model. The variables included are listed in <a href="#tbl-dtvars" class="quarto-xref">Table&nbsp;2</a>. To validate the model, public water systems from three states (New Jersey, Connecticut &amp; California) were joined to census blocks to classify the intersecting blocks as public water users. These three states were chosen based on the completeness and detail of their service area boundaries. The final decision tree model (<a href="#fig-dt" class="quarto-xref">Figure&nbsp;3</a>) predicted the type of water supply correctly in 93.14% of blocks in the testing dataset which was removed prior to training. The accuracy of public use (sensitivity) was 95% and the accuracy of private use (specificity) was 81%. A secondary validation was performed using data from Washington, which was never exposed to the model for training (<a href="#tbl-wash" class="quarto-xref">Table&nbsp;3</a>) For more details on this initial model, refer to the <a href="https://github.com/USEPA/ORD_Water_Source_2020">2020 Water Source Model GitHub Site</a>.</p>
<div class="cell">
<div id="tbl-dtvars" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-dtvars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Variables included in decision tree model.
</figcaption>
<div aria-describedby="tbl-dtvars-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="img/varTable.png" class="img-fluid figure-img" width="986"></p>
</figure>
</div>
</div>
</div>
</figure>
</div>
</div>
<div id="tbl-wash" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-wash-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: Confusion matrix showing both decision tree predictions for both the out of bag testing set and data from Washington.
</figcaption>
<div aria-describedby="tbl-wash-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/performance_tbl.png" class="img-fluid figure-img" style="width:3in">
</div>
</figure>
</div>
<div id="fig-dt" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-dt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/DT.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-dt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Visualization of decision tree to predict whether a census block is served by a public water system.
</figcaption>
</figure>
</div>
</section>
<section id="match" class="level2">
<h2 class="anchored" data-anchor-id="match">1:1 Match</h2>
<p>Census blocks that are predicted to be served by public water by the binary water use model (<a href="#fig-dt" class="quarto-xref">Figure&nbsp;3</a>) are ‘aggregated’ or ‘dissolved’ spatially, meaning they are combined with any contiguous blocks that are also estimated to be served by public water systems into larger polygons. A public probability threshold of .7 and higher was used to classify block as exclusively on public water. These aggregated polygons are then spatially joined with facility locations from SDWIS, which include intakes, wells, and treatment plants. If a single aggregated area can only be associated with facilities from a single public water system, that area is assigned its associated PWSID.</p>
<p>As a general approach to modeling, simplicity is typically preferred over complexity. The 1:1 matching was an attempt to resolve system assignments in a very simple way, eliminating the need for more complex random forest modeling. Approximately 8,000 systems were assigned (or matched) using this method. This method leveraged the decision tree output to determine system boundary size. Since the model provided confidence levels associated to every block, from 0=confident that that the block is privately supplied; to 1= confident that block is publicly supplied. We found that a value of 0.7 closely approximated the system boundary size and shape when compared to state supplied boundaries. After applying this criteria, we sought to match the system boundaries to their associated PWSID. Spatially continuous blocks were aggregated together into larger polygons.</p>
<p>To determine a match, we used SDWIS locations (wells, treatment plant, intakes) and SDWIS locations (reported system addresses that we geocoded) to conduct a spatial join to the aggregated decision tree boundaries (at 0.7 confidence). The logic here is that for some systems there is only one PWS that serves the polygon area—as opposed to a more complex nested set of systems within a single polygon. More complex systems are mainly associated with urban and suburban areas where the simple systems are largely associated with smaller to mid-size towns in rural areas. The other assumption we had was that it is more likely that a system’s infrastructure is close to the population that it serves than farther away.</p>
<p>We performed a spatial join on all decision tree boundaries and SDWIS locations. If more than one unique system was joined, those boundaries were returned for random forest modeling. If only one PWSID was returned for a polygon we validated that the joins were associated with the correct PWS. To do this we performed a graphical validation method by regressing the service connection of the joined public water system against the sum 2020 housing units within the modeled boundary. Because each state uses a different formula for calculating the service connections, these regressions had to be limited to intra-state comparisons. In other words, the regressions coefficients could vary widely between states, creating an “apples-to-oranges” comparison. The regression was trimmed to systems that fell close to the 1-to-1 regression line. Systems that deviated from that line were removed for later random forest matching. <a href="#fig-IA" class="quarto-xref">Figure&nbsp;4</a> is an example of Iowa systems that were matched using this graphical method for matching systems.</p>
<div id="fig-IA" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-IA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/IA_Regression.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-IA-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: example of “matched” 1:1 systems using the graphical regression method. These systems have a strong correlation between housing units (x) and reported service connections (y). The bottom right image shows how census block housing units are aggregated per unique PWS
</figcaption>
</figure>
</div>
</section>
<section id="random-forest" class="level2">
<h2 class="anchored" data-anchor-id="random-forest">Random Forest</h2>
<p>The goal of the random forest model is to be able to determine what public water system (or PWSID) a census block is most likely to be served by. For example, a block in a rural area that is using public water may be more likely to be close to its source water intake if it is a very small system and more likely to be farther away if it a very large rural water district. If you are served by a system that purchases all of its water, the infrastructure may be farther away as well.</p>
<p>The random forest is set up to evaluate the relationship between a single census block and a single point associated with a public water system. The tabular data used to train and apply the random forest model has one row for the relationship between every block and every unique PWSID within 25 miles (as determined by CWS infrastructure such as wells, treatment plants, facility addresses, and intakes). As an example, if there are seven different facilities within twenty-five miles of a census block, the table used for the random forest will have seven rows for that census block. Each facility is associated with a parent PWSID. The random forest model then predicts a probability that the parent PWSID is serving the census block in the same row of the table. Predictor variables can be thought of as belonging to one of two groups:</p>
<ul>
<li>Variables that that characterize the census block</li>
<li>Variables that characterize the water system.</li>
</ul>
<p>The random forest model then determines the correct interplay between the variables to determine a probability that a particular system serves a particular census block or is not served by a public water system at all.</p>
<section id="variables-that-describe-the-census-block" class="level3">
<h3 class="anchored" data-anchor-id="variables-that-describe-the-census-block">Variables that Describe the Census Block</h3>
<section id="population" class="level4">
<h4 class="anchored" data-anchor-id="population">Population</h4>
<p>Variable Name: <code>Population</code></p>
<p>Population is taken from the 2020 Census, obtained at the census block level from ‘2020_DHCa’ downloaded from NHGIS <span class="citation" data-cites="manson2023ipums">(<a href="#ref-manson2023ipums" role="doc-biblioref">Manson et al. 2023</a>)</span>.</p>
</section>
<section id="local-population-density" class="level4">
<h4 class="anchored" data-anchor-id="local-population-density">Local Population Density</h4>
<p>Variable Name: <code>Pop_km</code></p>
<p>The centroid of each block is buffered by 2 miles (3,218.69 meters). The population density is then calculated as an areal weighted population density of census blocks that intersect the buffer. This variable informs each block of its surroundings—in particular how dense is the nearby city, suburb or rural area.</p>
</section>
<section id="area" class="level4">
<h4 class="anchored" data-anchor-id="area">Area</h4>
<p>Variable Name: <code>Area_Km</code></p>
<p>Area is calculated for each block in square kilometers using the Albers equal area projection (crs = 5070).</p>
</section>
<section id="probability-of-public-water" class="level4">
<h4 class="anchored" data-anchor-id="probability-of-public-water">Probability of Public Water</h4>
<p>Variable Name: <code>Prob_Pub</code></p>
<p>The probability (0-1) of a block being served by public water as estimated from the ORD water use decision tree model (<a href="#fig-dt" class="quarto-xref">Figure&nbsp;3</a>).</p>
</section>
<section id="buildings" class="level4">
<h4 class="anchored" data-anchor-id="buildings">Buildings</h4>
<p>Variable Name: <code>nBuildings</code></p>
<p>The number of buildings within a census block that are greater then 50 square meters in area. This is calculated using Microsoft building footprints <span class="citation" data-cites="mbfp">(<a href="#ref-mbfp" role="doc-biblioref">Microsoft 2023</a>)</span>. We use a cutoff of 50 square meters to remove smaller buildings such as detached garages and sheds (<a href="#fig-mbfp" class="quarto-xref">Figure&nbsp;5</a>).</p>
<div id="fig-mbfp" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-mbfp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/mbfp.png" class="img-fluid figure-img" style="width:4in">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mbfp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Aerial image showing Microsoft building footprints of a larger two-car garage and a residential home. Annotations show the garage is just under fifty square meters.
</figcaption>
</figure>
</div>
</section>
<section id="percent-buildings" class="level4">
<h4 class="anchored" data-anchor-id="percent-buildings">Percent Buildings</h4>
<p>Variable Name: <code>PctBldg</code></p>
<p>The percent area of the census block that is covered by buildings. This is calculated as the total area of microsoft building footprints divided by the area of the census block <span class="citation" data-cites="mbfp">(<a href="#ref-mbfp" role="doc-biblioref">Microsoft 2023</a>)</span>.</p>
</section>
<section id="mean-building-area" class="level4">
<h4 class="anchored" data-anchor-id="mean-building-area">Mean Building Area</h4>
<p>Variable Name: <code>meanBldg_m</code></p>
<p>The mean area in square meters of buildings within the census block <span class="citation" data-cites="mbfp">(<a href="#ref-mbfp" role="doc-biblioref">Microsoft 2023</a>)</span>.</p>
</section>
<section id="minimum-building-area" class="level4">
<h4 class="anchored" data-anchor-id="minimum-building-area">Minimum Building Area</h4>
<p>Variable Name: <code>minBldg_m</code></p>
<p>The area in square meters of the smallest building within the census block (Only buildings greater than or equal to 50 square meters included) <span class="citation" data-cites="mbfp">(<a href="#ref-mbfp" role="doc-biblioref">Microsoft 2023</a>)</span>.</p>
</section>
<section id="maximum-building-area" class="level4">
<h4 class="anchored" data-anchor-id="maximum-building-area">Maximum Building Area</h4>
<p>Variable Name: <code>maxBldg_m</code></p>
<p>The area in square meters of the largest building within the census block (Only buildings greater than or equal to 50 square meters included) <span class="citation" data-cites="mbfp">(<a href="#ref-mbfp" role="doc-biblioref">Microsoft 2023</a>)</span>.</p>
</section>
<section id="standard-deviation-of-building-area" class="level4">
<h4 class="anchored" data-anchor-id="standard-deviation-of-building-area">Standard Deviation of Building Area</h4>
<p>Variable Name: <code>sdBldg_m</code></p>
<p>The standard deviation of area of buildings in square meters within a census block <span class="citation" data-cites="mbfp">(<a href="#ref-mbfp" role="doc-biblioref">Microsoft 2023</a>)</span>.</p>
</section>
<section id="rural-urban" class="level4">
<h4 class="anchored" data-anchor-id="rural-urban">Rural / Urban</h4>
<p>Variable Name: <code>PctRural</code></p>
<p>The census defined urban / rural classifier; A binary classification, in which to qualify as an urban area, the block identified must encompass at least 2,000 housing units or have a population of at least 5,000 for 2020 (census block level). The dataset used is ‘Urban and Rural’ from ‘2020_DHCa’ at the census block level, obtained from NHGIS <span class="citation" data-cites="manson2023ipums">(<a href="#ref-manson2023ipums" role="doc-biblioref">Manson et al. 2023</a>)</span></p>
</section>
<section id="mean-residential-acres" class="level4">
<h4 class="anchored" data-anchor-id="mean-residential-acres">Mean Residential Acres</h4>
<p>Variable Name: <code>meanResAcres</code></p>
<p>The mean value in acres of parcels within the census block that are zoned for residential use <span class="citation" data-cites="regrid">(<a href="#ref-regrid" role="doc-biblioref">REGRID 2023</a>)</span>.</p>
</section>
<section id="count-of-parcels" class="level4">
<h4 class="anchored" data-anchor-id="count-of-parcels">Count of Parcels</h4>
<p>Variable Name: <code>nParcels</code></p>
<p>The total count of parcels within the census block <span class="citation" data-cites="regrid">(<a href="#ref-regrid" role="doc-biblioref">REGRID 2023</a>)</span>.</p>
</section>
<section id="count-of-mobile-homes" class="level4">
<h4 class="anchored" data-anchor-id="count-of-mobile-homes">Count of Mobile Homes</h4>
<p>Variable Name: <code>MH_Count</code></p>
<p>The count of mobile home communities within a census block as derived from the Homeland Infrastructure Foundation Level database <span class="citation" data-cites="hifld">(<a href="#ref-hifld" role="doc-biblioref">HIFLD 2023</a>)</span>.</p>
</section>
<section id="mobile-home-size" class="level4">
<h4 class="anchored" data-anchor-id="mobile-home-size">Mobile Home Size</h4>
<p>Variable Name: <code>MH_Size</code></p>
<p>The cumulative size of mobile home parks within a census block representing the number of mobile home units <span class="citation" data-cites="hifld">(<a href="#ref-hifld" role="doc-biblioref">HIFLD 2023</a>)</span>. This variable is presented as a factor.</p>
<p><strong>Possible Values:</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>‘50’</td>
<td>&lt;50 Mobile Homes</td>
</tr>
<tr class="even">
<td>‘75’</td>
<td>50-100 Mobile Homes</td>
</tr>
<tr class="odd">
<td>‘100’</td>
<td>&gt;100 Mobile Homes</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="variables-that-describe-the-closest-systems" class="level3">
<h3 class="anchored" data-anchor-id="variables-that-describe-the-closest-systems">Variables that Describe the Closest Systems</h3>
<section id="distance" class="level4">
<h4 class="anchored" data-anchor-id="distance">Distance</h4>
<p>Variable Name: <code>Facility_Dist</code> The distance in meters between the census block centroid and a single point from SDWIS for a system.</p>
</section>
<section id="distance-rank" class="level4">
<h4 class="anchored" data-anchor-id="distance-rank">Distance Rank</h4>
<p>Variable Name: <code>Dist_Rank</code></p>
<p>Describes the closeness rank of the particular facility being measured to. For example, if <code>Dist_Rank = 5</code>, there would be 4 other facility points closer to the centroid of that census block.</p>
</section>
<section id="facility-type" class="level4">
<h4 class="anchored" data-anchor-id="facility-type">Facility Type</h4>
<p>Variable Name: <code>Facility_Type</code></p>
<p>The type of system point that was used in the distance calculation. Options include:</p>
<ul>
<li>“Well”</li>
<li>“Treatment Plant”</li>
<li>“Consecutive Connection”</li>
<li>“Intake”</li>
<li>“Other”</li>
</ul>
<p>The ‘Other’ Category contains less frequent data and data used when there are no wells, intakes or treatment plants associated with a system. Some examples of less frequent locations are springs, reservoirs and infiltration zones. This class also contains the administrative contact addresses of systems as reported to SDWIS which are typically within a service area but are also known to be unreliable depending on the system. Administrative contact addresses were geolocated and curated to only include street intersections or better.</p>
</section>
<section id="population-served" class="level4">
<h4 class="anchored" data-anchor-id="population-served">Population Served</h4>
<p>Variable Name: <code>Population_Served_Count</code></p>
<p>The reported population that is served by the system in SDWIS reporting.</p>
</section>
<section id="connections" class="level4">
<h4 class="anchored" data-anchor-id="connections">Connections</h4>
<p>Variable Name: <code>Service_Connections_Count</code></p>
<p>The reported number of service connections within a system in SDWIS reporting.</p>
</section>
<section id="distance-to-center-of-system" class="level4">
<h4 class="anchored" data-anchor-id="distance-to-center-of-system">Distance to Center of System</h4>
<p>Variable Name: <code>Ctr_Dist</code></p>
<p>If a system has more than one SDWIS point (intakes, wells treatment plants etc…) the mean center of all points is calculated and measured in meters from the centroid of the census block. If only one point exists within a system, this value will be identical to <code>Facility_Dist</code>.</p>
</section>
<section id="system-type" class="level4">
<h4 class="anchored" data-anchor-id="system-type">System Type</h4>
<p>Variable Name: <code>Service_Area_Type</code></p>
<p>The Primary type of area that is served by the public water system.</p>
<p><strong>Possible Values:</strong></p>
<ul>
<li>‘Homeowners Association’</li>
<li>‘Mobile Home Park’</li>
<li>‘Multiple’</li>
<li>‘Municipality’<br>
</li>
<li>‘Other’</li>
<li>‘Residential Area’</li>
<li>‘Subdivision’</li>
</ul>
</section>
<section id="sub-county-match" class="level4">
<h4 class="anchored" data-anchor-id="sub-county-match">Sub-County Match</h4>
<p>Variable Name: <code>SubCounty_Match</code></p>
<p>Reflects a classified Jaro-Winkler string distance between the census place the census block is within and the ‘City Served’ of the public water system associated with the point being measured to.</p>
<table class="table">
<thead>
<tr class="header">
<th>Jaro-Winkler Distance</th>
<th>Classification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt;0.1</td>
<td>“Full Match”</td>
</tr>
<tr class="even">
<td>&gt;0.1 &amp; &lt;0.3</td>
<td>“Partial Match”</td>
</tr>
<tr class="odd">
<td>≥0.3</td>
<td>“No Match”</td>
</tr>
<tr class="even">
<td>if no census sub county</td>
<td>“No SubCounty”</td>
</tr>
<tr class="odd">
<td>if no city served</td>
<td>“No City Served”</td>
</tr>
</tbody>
</table>
</section>
<section id="place-match" class="level4">
<h4 class="anchored" data-anchor-id="place-match">Place Match</h4>
<p>Variable Name: <code>Place_Match</code></p>
<p>Reflects a classified Jaro-Winkler string distance between the census place the census block is within and the ‘City Served’ of the public water system associated with the point being measured to.</p>
<table class="table">
<thead>
<tr class="header">
<th>Jaro-Winkler Distance</th>
<th>Classification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt;0.1</td>
<td>“Full Match”</td>
</tr>
<tr class="even">
<td>&gt;0.1 &amp; &lt;0.3</td>
<td>“Partial Match”</td>
</tr>
<tr class="odd">
<td>≥0.3</td>
<td>“No Match”</td>
</tr>
<tr class="even">
<td>if no census place</td>
<td>“No Place”</td>
</tr>
<tr class="odd">
<td>if no city served</td>
<td>“No City Served”</td>
</tr>
</tbody>
</table>
</section>
<section id="county-match" class="level4">
<h4 class="anchored" data-anchor-id="county-match">County Match</h4>
<p>Variable Name: <code>County_Match</code></p>
<p>A categorical value denoting whether the county that the census block is within matches a county reported to be served by the system being measured.</p>
<p><strong>Possible Values:</strong></p>
<ul>
<li>‘Match’</li>
<li>‘No Match’</li>
<li>‘No County’</li>
</ul>
</section>
<section id="place-name-present-in-system-name" class="level4">
<h4 class="anchored" data-anchor-id="place-name-present-in-system-name">Place Name Present in System Name</h4>
<p>Variable Name: <code>Place_in_PWS</code></p>
<p>A measure of how much of the system name also appears in the census place name that the census block is within. The longest common sub-string (LCS) is calculated between the census place and the system name and is then using the formula:</p>
<p><span class="math display">\[(pwsName_{length}-LCS)/Place_{length}\]</span> where <span class="math inline">\(pwsName_{length}\)</span> is the length of the place name string in characters, <span class="math inline">\(Place_{length}\)</span> is the length of the public water system name in characters and <span class="math inline">\(LCS\)</span> is the length of the longest common sub-string between the two. An exact match would result in a value of 1. If either string is missing, a value of zero is assigned.</p>
</section>
<section id="sub-county-name-present-in-system-name" class="level4">
<h4 class="anchored" data-anchor-id="sub-county-name-present-in-system-name">Sub-County Name Present in System Name</h4>
<p>Variable Name: <code>SC_in_PWS</code></p>
<p>A measure of how much of the system name also appears in the census sub-county name that the census block is within. The longest common sub-string (LCS) is calculated between the census sub-county and the system name and is then using the formula:</p>
<p><span class="math display">\[(pwsName_{length}-LCS)/SubCounty_{length}\]</span> where <span class="math inline">\(pwsName_{length}\)</span> is the length of the place name string in characters, <span class="math inline">\(SubCounty_{length}\)</span> is the length of the public water system name in characters and <span class="math inline">\(LCS\)</span> is the length of the longest common sub-string between the two. An exact match would result in a value of 1. If either string is missing, a value of zero is assigned.</p>
</section>
</section>
<section id="training-validation" class="level3">
<h3 class="anchored" data-anchor-id="training-validation">Training &amp; Validation</h3>
<p>The random forest is applied to every census block and returns a probability for each facility location within 25 miles of each census block. That probability can be interpreted as the probability that the system PWSID associated with that facility is serving public water to that census block. A full comparison between the training and testing sets is shown in <a href="#tbl-train" class="quarto-xref">Table&nbsp;4</a></p>
<p>The data used to build the random forest model was split randomly across Arizona, Arkansas, California, Connecticut, New Jersey and Texas into training and testing sets (<a href="#tbl-train" class="quarto-xref">Table&nbsp;4</a>). These six states were chosen due to their relative accuracy and completeness when inspected and evaluated against the current universe of active community water systems. Data is split into separate sets so the relationships constructed by the random forest model can be evaluated against data it has not been exposed to (out-of-bag sample).</p>
<div id="tbl-train" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-train-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Summary statistics of the training and testing sets used to build the random forest.
</figcaption>
<div aria-describedby="tbl-train-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>Training Set</th>
<th>Testing Set</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td># Rows</td>
<td>3.1 Million</td>
<td>47 Million</td>
</tr>
<tr class="even">
<td># Census Blocks</td>
<td>760 Thousand</td>
<td>1.1 Million</td>
</tr>
<tr class="odd">
<td># Correct</td>
<td>350 Thousand</td>
<td>4.2 Million</td>
</tr>
<tr class="even">
<td># Incorrect</td>
<td>2.8 Million</td>
<td>42.7 Million</td>
</tr>
<tr class="odd">
<td># Systems</td>
<td>1.7 Thousand</td>
<td>1.7 Thousand</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>The random forest model was tuned on the number of trees and the value of m-try (the number of random variables considered at each split). The final model used a forest of fifty decision trees with <span class="math inline">\(m_{try}=20\)</span>. The out-of-bag testing set returned 4,201,409 ‘TRUE’ predictions (the system PWSID is correct) and 42,738,447 ‘FALSE’ predictions (the system PWSID is not correct) and predicted 99.7% of rows correctly. The sensitivity (accuracy of true positives) was 98.38% and the specificity (accuracy of true negatives) was 99.83%. The kappa value for the entire testing set was 0.982.</p>
</section>
</section>
</section>
<section id="post-processing" class="level1">
<h1>Post Processing</h1>
<p>The random forest model was post processed to simplify the boundary results and remove spatial outliers.</p>
<section id="hole-filling" class="level2">
<h2 class="anchored" data-anchor-id="hole-filling">Hole Filling</h2>
<p>Random forest outputs were spatially aggregated from the census block to the PWSID. To overcome spatial issues, such as interstate highways and right-of-ways, blocks were buffered by one-hundred meters, dissolved on the PWSID, then negatively buffered by one-hundred meters to conserve the correct footprint. A function to remove interior holes <span class="citation" data-cites="nngeo">(<a href="#ref-nngeo" role="doc-biblioref">Dorman 2022</a>)</span>.</p>
</section>
<section id="polygon-part-removal-distance" class="level2">
<h2 class="anchored" data-anchor-id="polygon-part-removal-distance">Polygon Part Removal (Distance)</h2>
<p>For random forest outputs, if a system had more than one polygon that did not connect, we measured the distance between the largest polygon for the system and each of the satellite polygons. If the satellite polygon was more than ten kilometers away and had a lesser probability than the primary polygon, it was deleted.</p>
</section>
<section id="polygon-part-removal-area" class="level2">
<h2 class="anchored" data-anchor-id="polygon-part-removal-area">Polygon Part Removal (Area)</h2>
<p>It was discovered that there were many small “artifacts” the model created: small in size and mostly isolated blocks that were relatively far away from where their parent (primary—or largest) system boundary was located. To carefully remove these, the features were ‘exploded’ so unique polygon parts could be examined individually. Before ‘explosion’, the total aggregate system size was calculated (Km<sup>2</sup>). The exploded polygon parts size was then calculated (Km<sup>2</sup>), and each polygon part area was divided by the total system area in order to get a percent of total area. To remove these fragments, a threshold was applied: any polygon part that was less than 20% of the total system area and was less than 3 km<sup>2</sup> in size was removed. This eliminated some 100k polygon parts. After this procedure, only ~48,000 polygon parts remained (close to the number of total systems—suggesting most systems now only have 1 polygon per system.</p>
</section>
</section>
<section id="dataset-universe-known-issues" class="level1">
<h1>Dataset Universe &amp; Known Issues</h1>
<p>The universe of systems we attempt to model is 47,952 systems. We were able to model or gather state supplied boundaries for 42,743 systems (89%). The unmatched systems predominately serve relatively small populations. This is proven when we calculate the percent of the population served by modeled boundaries vs the universe of systems: 98.3%. This high percentage gives us confidence that we are capturing the service area boundaries for most people reliant on public water. Figure 7 shows the percent of modeled/state supplied boundaries and their percent population served of the total universe.</p>
<p>We remove any system that serves less than 25 people or has less than 15 service connections (unless we were able to model them or they were state supplied)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. These systems are typically sub-block in size and cannot reasonably be modeled. A large majority of these systems also did not meet the federal definition of a public water system.<br>
Systems that are exclusively wholesalers of water were also removed from the universe because these systems don’t distribute water to customers—and thus have no service area boundaries. Puerto Rico and US territory systems are not included because explanatory data for model inputs are not available for these geographies.</p>
<p>The final output dataset includes 42,743 systems out of a universe of 47,952 (89.1%)</p>
<section id="population-served-by-state" class="level3">
<h3 class="anchored" data-anchor-id="population-served-by-state">Population Served by State</h3>
<p>The modeled boundaries represent 98.3 % of the population served as reported in SDWIS (<a href="#fig-statePopServed" class="quarto-xref">Figure&nbsp;6</a>).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-statePopServed" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-statePopServed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Documentation_files/figure-html/fig-statePopServed-1.png" class="img-fluid figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-statePopServed-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Bar plot showing the percent of population served by state or region that is captured by service area boundaries. Regions refer to tribal systems within that EPA region.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="overlapping-boundaries" class="level2">
<h2 class="anchored" data-anchor-id="overlapping-boundaries">Overlapping Boundaries</h2>
<p>Within the final dataset there are instances where two or more boundaries occupy the same area. Theoretically two or more systems can occupy a single block (the spatial scale of the model) but this is known to be rare. Overlaps usually occur in two scenarios:</p>
<ol type="1">
<li>State boundaries overlapping modeled boundaries: <a href="#fig-overlap1" class="quarto-xref">Figure&nbsp;7</a> shows an example of Altoona, IA (modeled) overlapping the state supplied boundary of Des Moines. In this example the modeled boundary for Altoona appears correct. Altoona has a unique PWS. However, the state supplied boundary didn’t “erase” the Altoona system from the service area boundary. This conflict is a function of course or inaccurate state supplied boundaries.</li>
</ol>
<div id="fig-overlap1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-overlap1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/overlap1.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-overlap1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: State boundary (pink) overlapping a modeled boundary (purple)
</figcaption>
</figure>
</div>
<ol start="2" type="1">
<li>State boundaries overlapping other state boundaries: <a href="#fig-overlap2" class="quarto-xref">Figure&nbsp;8</a> shows an example of two state systems overlapping each other. Because these are state supplied boundaries, nothing can be done to resolve this issue. They are either incorrectly drawn or multiple systems serve approximately the same areas.</li>
</ol>
<div id="fig-overlap2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-overlap2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="img/overlap2.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-overlap2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Multiple California state supplied boundaries overlapping each other.
</figcaption>
</figure>
</div>
</section>
<section id="incorrect-locations" class="level2">
<h2 class="anchored" data-anchor-id="incorrect-locations">Incorrect Locations</h2>
<p>All models have error. Trying to accurately model such a complex human phenomenon such as public drinking water infrastructure is difficult. The drivers that manifest a public drinking infrastructure—economic, social, environmental—is also complex and varies from state-to-state, community-to-community. The decision tree model was trained on 3 states and the random forest was trained on 6 states. This limited geographic range creates bias in the model and may not represent different drinking water infrastructure assumptions that may be relevant in one state, but not in others. One known issue is the poor accuracy of rural water systems serving very rural geographies. Our decision tree dataset was trained on states with a fairly urban population and states that didn’t have very many rural water districts to train the model on. South Dakota, for example, is a state with many rural water districts that cover large swaths of the rural landscape. We deliberately avoided including such districts in our training dataset because rural water districts are unique to only some states. Generally speaking, rural farmland does not have public water—so we did not want to train a model that saw farmland as being served by public water. Because of this model bias, modeled rural water districts are a known issue in our model and are typically not modeled accurately.</p>
</section>
<section id="missing-systems" class="level2">
<h2 class="anchored" data-anchor-id="missing-systems">Missing Systems</h2>
<p>Why can some systems not be modeled? Besides the issue of systems being too small to model, there is another reason. The model requires geographic signals, or clues, to accurately place a service area boundary on the map. These geographic clues come primarily from two sources: 1.) SDWIS locations such as wells, intakes, and treatment plants and 2.) SDWIS reported system information such as ‘City Served’. These signals help the model triangulate an appropriate geography for the service area. Approximately a dozen states don’t report “City Served’. In addition some systems don’t have corresponding SDWIS point locations or the information they provide is incorrect. For these reasons, a good portion of the systems that could not be modeled were not modeled. For example, <a href="#fig-missingCon" class="quarto-xref">Figure&nbsp;9</a> shows the vast majority of systems we could not model report less than 100 connections. Certain types of systems are also difficult to model. As represented in <a href="#fig-missingType" class="quarto-xref">Figure&nbsp;10</a>, the areas we struggle to model are areas like mobile home park or subdivisions.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-missingCon" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-missingCon-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Documentation_files/figure-html/fig-missingCon-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-missingCon-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Histogram of systems we do not have boundaries for by the number of service connections reported under SDWA. binwidth = 10 connections.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-missingType" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-missingType-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="Documentation_files/figure-html/fig-missingType-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-missingType-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Bar plot showing the percent of systems missing boundaries by the type of area they primarily serve.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="kentucky" class="level2">
<h2 class="anchored" data-anchor-id="kentucky">Kentucky</h2>
<p>According to the state of Kentucky, about 95% of Kentuckians have access to public drinking water <span class="citation" data-cites="kydow">(<a href="#ref-kydow" role="doc-biblioref">Water 2022</a>)</span>. Kentucky is relatively unique in the broad reach of their water systems to rural areas. While Kentucky does not publish service area boundaries, We received water line data from the state of kentucky, associated with PWSIDs, which delineated the main water lines. To delineate service areas, Voronoi polygons (also known as Thiessen polygons) were generated from service line data. It should be noted that the Voronoi polygons were derived from state supplied data, but the polygons themselves are not state supplied.</p>
</section>
<section id="florida" class="level2">
<h2 class="anchored" data-anchor-id="florida">Florida</h2>
<p>For some state supplied boundaries in Florida, one polygon was associated with multiple PWSIDs. We are unable to disaggregate these multiple systems from their single geography. For these features in the dataset, you will see multiple PWSIDs within the ‘PWSID’ field.</p>
</section>
</section>
<section id="code-and-additional-resources" class="level1">
<h1>Code and Additional Resources</h1>
<p>The data curation, modeling and analysis for this work was done using R <span class="citation" data-cites="R">(<a href="#ref-R" role="doc-biblioref">R Core Team 2022</a>)</span> and R Studio <span class="citation" data-cites="rstudio">(<a href="#ref-rstudio" role="doc-biblioref">Posit team 2023</a>)</span>. All code can be viewed in the EPA agency GitHub page available at: <a href="https://github.com/USEPA/ORD_SAB_Model" class="uri">https://github.com/USEPA/ORD_SAB_Model</a>. Additional information is also available in this repository such as source information for boundary data obtained from state and utility sources.</p>

</section>


<div id="quarto-appendix" class="default"><section id="appendix-a" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">Appendix A</h2><div class="quarto-appendix-contents">

<p>I am grateful for the insightful comments offered by the anonymous peer reviewers at Books &amp; Texts. The generosity and expertise of one and all have improved this study in innumerable ways and saved me from many errors; those that inevitably remain are entirely my own responsibility.</p>

</div></section><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-act1974safe" class="csl-entry" role="listitem">
Act, Safe Drinking Water. 1974. <span>“Safe Drinking Water Act.”</span> In <em>Enacted by the 93rd United States Congress. Effective</em>. Vol. 88.
</div>
<div id="ref-nngeo" class="csl-entry" role="listitem">
Dorman, Michael. 2022. <em>Nngeo: K-Nearest Neighbor Join for Spatial Data</em>. <a href="https://CRAN.R-project.org/package=nngeo">https://CRAN.R-project.org/package=nngeo</a>.
</div>
<div id="ref-epaCompliance" class="csl-entry" role="listitem">
EPA, U. S. 2023. <span>“Providing Safe Drinking Water in America: National Public Water Systems Compliance Report.”</span> https://www.epa.gov/compliance/providing-safe-drinking-water-america-national-public-water-systems-compliance-report.
</div>
<div id="ref-cws" class="csl-entry" role="listitem">
EPA, US. 2022. <span>“Information about Public Water Systems.”</span> https://www.epa.gov/dwreginfo/information-about-public-water-systems.
</div>
<div id="ref-hifld" class="csl-entry" role="listitem">
HIFLD. 2023. <span>“Homeland Infrastructure Foundation-Level Data.”</span> https://services1.arcgis.com/Hp6G80Pky0om7QvQ/arcgis/rest/services/Mobile_Home_Parks/FeatureServer/0.
</div>
<div id="ref-manson2023ipums" class="csl-entry" role="listitem">
Manson, Steven M, Jonathan Schroeder, David Van Riper, Katherine Knowles, Tracy Kugler, Finn Roberts, and Steven Ruggles. 2023. <span>“IPUMS National Historical Geographic Information System: Version 18.0.”</span>
</div>
<div id="ref-mbfp" class="csl-entry" role="listitem">
Microsoft. 2023. <span>“US Building Footprints.”</span> https://github.com/microsoft/USBuildingFootprints?tab=readme-ov-file.
</div>
<div id="ref-rstudio" class="csl-entry" role="listitem">
Posit team. 2023. <em>RStudio: Integrated Development Environment for r</em>. Boston, MA: Posit Software, PBC. <a href="http://www.posit.co/">http://www.posit.co/</a>.
</div>
<div id="ref-R" class="csl-entry" role="listitem">
R Core Team. 2022. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.
</div>
<div id="ref-regrid" class="csl-entry" role="listitem">
REGRID. 2023. <span>“REGRID Parcels Feature Service.”</span> https://epa.maps.arcgis.com/home/item.html?id=75da303642e74f4b8b25caa6c1bbfad0.
</div>
<div id="ref-toccalino2010quality" class="csl-entry" role="listitem">
Toccalino, Patricia L, Julia E Norman, and Kerie J Hitt. 2010. <span>“Quality of Source Water from Public-Supply Wells in the United States, 1993-2007.”</span> US Geological Survey.
</div>
<div id="ref-kydow" class="csl-entry" role="listitem">
Water, Kentucky Division of. 2022. <span>“Drinking Water.”</span> https://eec.ky.gov/Environmental-Protection/Water/Drinking/Pages/Drinking.
</div>
</div></section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>This is similar to the EPA definition of a public water provider: “A public water system provides water for human consumption through pipes or other constructed conveyances to at least 15 service connections or serves an average of at least 25 people for at least 60 days a year.” https://www.epa.gov/dwreginfo/information-about-public-water-systems<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>